<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Mi Mapa Mágico</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="estilos/estilosmapamagico.css"/>
  <link rel="stylesheet" href="estilos/estiloslogin.css"/>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-[#fef3c7] background-pattern font-[Poppins] text-[#78350f] min-h-screen p-4">
  <div class="fixed top-4 right-24 z-50">
    <a href="#" id="btnAyuda" class="bg-white/90 backdrop-blur-sm p-2 rounded-full shadow-md border border-white/70 flex items-center justify-center">
      <img src="imagenes/ayuda.png" alt="Ayuda" class="h-10 w-10 object-contain"/>
    </a>
  </div>
  <div class="max-w-5xl mx-auto">
    <h1 class="text-5xl font-bold text-center mb-4 tracking-wide">Mi Mapa Mágico</h1>
    <p class="text-center text-lg md:text-xl font-medium mb-6 px-4">
      Este mapa no es solo geografía, es un portal a las costumbres, palabras y valores de tus alumnos. Agrega información cultural de tus alumnos para estimular el conocimiento de la diversidad cultural presente en el aula, además de que podrás descargar el mapa para trabajar en clase.
    </p>

    <!-- Botón de registrar -->
    <div class="flex justify-center mb-6">
      <button id="abrirFormulario" class="bg-[#78350f] text-[#fde68a] font-bold py-2 px-6 rounded hover:bg-[#fbbf24] hover:text-[#78350f] transition">
        Registrar alumno
      </button>
    </div>

    <!-- Mapa cultural -->
    <section id="mapa" class="relative bg-[#ffffff] backdrop-blur-sm p-6 md:p-8 rounded-2xl shadow-lg border border-[#78350f]">
      <h2 class="text-2xl font-semibold mb-4">Mapa Cultural</h2>
      <div id="contenedorMapa" class="relative w-full h-[600px] overflow-hidden rounded-xl shadow-inner"></div>

      <!-- Botones de descarga -->
      <div class="flex flex-wrap justify-center gap-4 mt-8">
        <button id="descargarMapa" class="bg-[#78350f] text-[#fde68a] font-bold py-2 px-6 rounded hover:bg-[#fbbf24] hover:text-[#78350f] transition">
          Descargar como Imagen
        </button>
        <button id="descargarPDF" class="bg-[#78350f] text-[#fde68a] font-bold py-2 px-6 rounded hover:bg-[#fbbf24] hover:text-[#78350f] transition">
          Descargar como PDF
        </button>
        <button id="descargarMapaLimpioPDF" class="bg-[#10B981] text-white font-bold py-2 px-6 rounded hover:bg-[#059669] transition">
          Descargar solo el mapa como PDF
        </button>
      </div>
    </section>
  </div>

  <!-- Modal del formulario -->
  <div id="modalFormulario" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
    <div class="bg-[#f5e6c8] p-6 rounded-xl shadow-xl w-full max-w-lg overflow-y-auto max-h-[90vh]">
      <h2 class="text-2xl font-semibold mb-4">Registrar alumno</h2>
      <form id="registroAlumno" class="space-y-4">
        <input type="hidden" id="indiceEdicion" value="-1" />

        <div>
          <label class="font-bold">Nombre del Alumno:</label><br/>
          <input type="text" id="nombre" required class="mt-1 p-2 w-full border border-[#78350f] rounded"/>
        </div>

        <div>
          <label class="font-bold">Lugar de Origen:</label><br/>
          <input type="text" id="origen" required class="mt-1 p-2 w-full border border-[#d95d39] rounded"/>
        </div>

        <div>
          <label class="font-bold">Costumbre especial:</label><br/>
          <input type="text" id="costumbre" class="mt-1 p-2 w-full border border-[#d95d39] rounded"/>
        </div>

        <div>
          <label class="font-bold">Palabra típica:</label><br/>
          <input type="text" id="palabra" class="mt-1 p-2 w-full border border-[#d95d39] rounded"/>
        </div>

        <div>
          <label class="font-bold">Avatar:</label><br/>
          <select id="avatar" class="mt-1 p-2 w-full border border-[#d95d39] rounded">
            <option value="niño">Niño</option>
            <option value="niña">Niña</option>
          </select>
        </div>

        <div>
          <label class="font-bold">Imagen de la costumbre (opcional):</label><br/>
          <input type="file" id="imagenCostumbre" accept="image/*" class="mt-1"/>
          <div id="vistaPrevia" class="mt-2"></div>
        </div>

        <div class="flex justify-end gap-4 mt-4">
          <button type="button" id="cancelar" class="text-[#4b3b2a] font-bold">Cancelar</button>
          <button type="submit" class="bg-[#78350f] text-[#fde68a] font-bold py-2 px-6 rounded hover:bg-[#fbbf24] hover:text-[#78350f] transition">Guardar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Mapa limpio solo para descarga -->
  <div id="mapaLimpio" class="hidden w-full h-[600px]">
    <img src="imagenes/mapa-mexico.jpg" alt="Mapa limpio" class="w-full h-full object-contain"/>
  </div>

  <!-- Librerías para exportar -->
  <script src="scripts/supabase.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="scripts/modelos.js"></script>
  <script src="scripts/mapa.js"></script>
</body>
</html>